# AR 圆柱体展示应用

这是一个基于Web的增强现实(AR)应用，使用手机摄像头扫描标记图形，在屏幕上展示虚拟的3D圆柱体。支持两种模式：**标记模式**和**固定模式**。

## 功能特性

- 📱 **移动端优化**: 专为手机浏览器设计
- 🎯 **双模式支持**: 标记模式和固定模式
- 🔄 **智能切换**: 用标记激活后可固定在摄像头中心
- 🎨 **动态效果**: 圆柱体带有旋转动画和装饰元素
- 🌈 **颜色切换**: 支持多种颜色切换
- 💫 **视觉特效**: 包含粒子效果和动画
- 🔔 **实时反馈**: 标记发现/丢失的实时通知

## 使用模式

### 标记模式
- 圆柱体跟随Hiro标记显示
- 标记丢失时圆柱体消失
- 适合演示和精确定位

### 固定模式 ⭐ 新功能
- 用标记激活圆柱体后，圆柱体固定在摄像头中心
- 不再依赖标记追踪，体验更流畅
- 可以自由移动手机，圆柱体始终保持在屏幕中央

## 技术栈

- **A-Frame**: 用于3D场景构建
- **AR.js**: 提供WebAR功能
- **HTML5**: 基础结构
- **CSS3**: 样式和动画
- **JavaScript**: 交互逻辑

## 使用方法

### 1. 环境要求

- 支持摄像头的移动设备（推荐）
- 现代浏览器（Chrome、Safari、Firefox等）
- HTTPS连接或本地环境

### 2. 启动应用

#### 方法一：本地服务器
```bash
# 使用启动脚本
./start.sh

# 或手动启动
python -m http.server 8000

# 或使用Node.js
npx http-server

# 然后在浏览器中访问
# http://localhost:8000
```

#### 方法二：直接打开
在支持的浏览器中直接打开 `index.html` 文件

### 3. 使用步骤

#### 标记模式（默认）
1. **允许摄像头权限**: 首次访问时允许浏览器访问摄像头
2. **获取标记**: 点击"显示标记"按钮查看Hiro标记图案
3. **扫描标记**: 将手机摄像头对准标记
4. **查看效果**: 圆柱体将跟随标记显示

#### 固定模式
1. **切换模式**: 点击"切换到固定模式"按钮
2. **激活圆柱体**: 将摄像头对准Hiro标记来激活圆柱体
3. **自由移动**: 圆柱体激活后将固定在摄像头中心，可以自由移动手机
4. **重置**: 点击"重置圆柱体"可以重新激活

### 4. 交互功能

- **显示/隐藏标记**: 点击相应按钮显示或隐藏标记图案
- **改变颜色**: 点击"改变颜色"按钮切换圆柱体颜色
- **模式切换**: 在标记模式和固定模式之间切换
- **重置圆柱体**: 在固定模式下重置圆柱体状态
- **键盘快捷键**:
  - `C`: 改变颜色
  - `M`: 显示/隐藏标记
  - `T`: 切换模式
  - `R`: 重置圆柱体（固定模式下）

## 文件结构

```
AR/
├── index.html          # 主HTML文件
├── script.js           # JavaScript逻辑
├── start.sh           # 启动脚本
└── README.md          # 说明文档
```

## 核心组件说明

### HTML结构
- AR场景使用A-Frame框架构建
- 包含标记检测和3D对象渲染
- 响应式UI界面
- 双圆柱体系统（标记圆柱体 + 固定圆柱体）

### JavaScript功能
- 模式切换逻辑
- 标记事件监听（发现/丢失）
- 圆柱体激活和重置
- 颜色切换逻辑
- 设备兼容性检查
- 用户交互处理

### 3D对象
- **标记圆柱体**: 跟随标记显示的AR对象
- **固定圆柱体**: 固定在摄像头中心的对象
- **装饰环**: 顶部和底部的旋转环
- **文字标签**: 显示模式信息
- **粒子效果**: 中心的动态球体

## 自定义配置

### 修改圆柱体属性
在 `index.html` 中找到圆柱体元素：
```html
<a-cylinder 
    id="ar-cylinder"
    position="0 1 0"
    radius="0.5"        <!-- 半径 -->
    height="2"          <!-- 高度 -->
    color="#FF6B6B">    <!-- 颜色 -->
</a-cylinder>
```

### 调整固定圆柱体位置
修改固定圆柱体的位置：
```html
<a-cylinder 
    id="fixed-cylinder"
    position="0 -1 -3"  <!-- X Y Z 坐标 -->
    ...>
</a-cylinder>
```

### 添加新颜色
在 `script.js` 中修改颜色数组：
```javascript
const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '你的新颜色'];
```

### 修改动画
调整动画参数：
```html
animation="property: rotation; to: 0 360 0; loop: true; dur: 4000"
```

## 故障排除

### 常见问题

1. **摄像头无法访问**
   - 确保浏览器有摄像头权限
   - 检查是否为HTTPS连接
   - 尝试刷新页面重新授权

2. **标记无法识别**
   - 确保标记图案清晰可见
   - 保持适当的距离（20-50cm）
   - 确保光线充足
   - 标记应该平整，无折痕

3. **固定模式圆柱体不显示**
   - 确保已切换到固定模式
   - 用标记激活圆柱体
   - 检查是否有JavaScript错误

4. **性能问题**
   - 关闭其他占用摄像头的应用
   - 使用性能较好的设备
   - 确保网络连接稳定

### 调试模式
在URL后添加调试参数：
```
http://localhost:8000/?debug=true
```

## 浏览器兼容性

| 浏览器 | 移动端 | 桌面端 | 备注 |
|--------|--------|--------|------|
| Chrome | ✅ | ✅ | 推荐 |
| Safari | ✅ | ✅ | iOS 11+ |
| Firefox | ✅ | ✅ | 需要HTTPS |
| Edge | ✅ | ✅ | 新版本 |

## 进阶功能

### 添加自定义标记
1. 创建自定义标记图案
2. 在AR.js中注册新标记
3. 修改HTML中的标记配置

### 添加更多3D对象
```html
<a-marker preset="hiro">
    <a-cylinder ...></a-cylinder>
    <a-box position="1 0 0" color="blue"></a-box>
    <a-sphere position="-1 0 0" color="green"></a-sphere>
</a-marker>
```

### 自定义固定位置
```javascript
// 在script.js中修改固定圆柱体的位置
function activateFixedCylinder() {
    // 自定义位置逻辑
    fixedContainer.setAttribute('position', '0 0 -2');
}
```

## 使用技巧

1. **最佳体验**: 在光线充足的环境下使用
2. **标记打印**: 建议打印标记到A4纸上使用
3. **距离控制**: 保持标记距离摄像头20-50cm
4. **模式选择**: 
   - 演示时使用标记模式
   - 交互时使用固定模式

## 许可证

本项目基于MIT许可证开源。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 联系方式

如有问题或建议，请通过GitHub Issues联系。 